import React, { useState, useEffect } from "react";
import Wrapper from "./Wrapper";

import Link from "next/link";
import Menu from "./Menu";
import MenuMobile from "./MenuMobile";

import { IoMdHeartEmpty } from "react-icons/io";
import { BsCart } from "react-icons/bs";
import { BiMenuAltRight } from "react-icons/bi";
import { VscChromeClose } from "react-icons/vsc";
import { useSelector } from "react-redux";

const Header = () => {
    const [mobileMenu, setMobileMenu] = useState(false);
    // const [showCatMenu, setShowCatMenu] = useState(false);
    const [show, setShow] = useState("translate-y-0");
    const [lastScrollY, setLastScrollY] = useState(0);

    const controlNavbar = () => {
        if (window.scrollY > 200) {
            if (window.scrollY > lastScrollY && !mobileMenu) {
                setShow("-translate-y-[80px]");
            } else {
                setShow("shadow-sm");
            }
        } else {
            setShow("translate-y-0");
        }
        setLastScrollY(window.scrollY);
    };

    useEffect(() => {
        window.addEventListener("scroll", controlNavbar);
        return () => {
            window.removeEventListener("scroll", controlNavbar);
        };
    }, [lastScrollY]);

    // useEffect(() => {
    //     fetchCategories();
    // }, []);


    return (
        <header
            className={`w-full h-[50px] md:h-[80px] bg-white flex items-center justify-between z-20 sticky top-0 transition-transform duration-300 ${show}`}
        >
            <Wrapper className="h-[60px] flex justify-between items-center">
                <Link href="/">
                    <svg width="32" height="27" viewBox="0 0 32 27" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_6_4)"><path d="M30.4128 23.0952C33.2725 18.9959 32.1716 13.4375 27.9535 10.6583C24.9794 8.69895 21.1045 8.60167 18.0304 10.3943C18.8454 5.51675 15.4423 0.917165 10.4236 0.111194C6.89185 -0.444647 3.33152 1.04223 1.31544 3.9326C-0.200201 6.10039 -2.25077e-05 11.1169 0.014276 11.1585V26.9861H23.8641H23.8355C26.5094 26.6804 28.9115 25.263 30.4128 23.0952Z" fill="#D10A1C"/><path d="M7.53532 14.2434L6.72031 17.9815H3.77482L4.8901 12.8677C4.933 12.6593 4.8472 12.4508 4.58983 12.4508C4.48974 12.4369 4.37535 12.4786 4.31816 12.562C4.03219 12.9094 3.33157 12.7288 3.66043 12.0062C4.04649 11.2836 4.73282 10.8667 5.8481 10.8667C6.8061 10.8667 7.24935 11.367 7.60681 12.1034H7.6926C8.37893 11.4364 9.19394 10.7694 10.2377 10.7694C10.9527 10.7694 11.8392 11.0473 12.0965 11.9784C12.7543 11.367 13.3262 10.7694 14.2842 10.7694C15.1564 10.7694 16.2002 11.0334 15.9571 12.7288C14.9419 13.368 14.1555 14.5075 14.1412 15.772C14.1412 16.8142 14.6274 17.5507 15.3852 17.9398C14.9991 18.0648 14.5988 18.1343 14.1841 18.1204C12.6685 18.1204 11.9535 17.0226 12.2824 15.6886L12.7543 13.771C12.8687 13.2985 13.0402 12.6037 12.4683 12.6037C12.0965 12.6037 11.8392 12.9789 11.6104 14.0489L10.7811 17.9954H7.83559L8.72209 13.771C8.82218 13.2985 9.00806 12.6037 8.43612 12.6037C8.02147 12.5898 7.80699 13.0206 7.53532 14.2434ZM18.2306 12.3397C19.1743 12.3397 20.3039 12.7566 20.3039 13.8543C20.2896 15.4802 18.0733 15.772 17.101 16.0638C17.2297 16.5224 17.53 16.6752 17.916 16.6752C18.3021 16.6752 18.9312 16.439 19.4888 16.0916C20.1323 15.6747 20.7471 15.2578 20.9616 14.841C21.0188 14.6603 21.0617 14.4797 21.076 14.299C21.1046 14.174 21.0474 14.035 20.8901 14.035C20.4897 14.035 20.6899 13.0206 21.6908 13.0206C22.6917 13.0206 23.0921 13.7154 22.9062 14.5769L22.6488 15.7998C22.5916 16.1055 22.4772 16.5502 22.8347 16.5502C23.0921 16.5502 23.235 16.2862 23.4066 15.4941L23.9214 13.104H25.8088L25.0939 16.3834C25.0653 16.5085 25.1081 16.6474 25.2797 16.6474C25.4227 16.6474 25.5371 16.5502 25.5514 16.3973C25.58 16.1889 26.0376 16.1055 26.0376 16.4807C26.0376 17.245 25.3941 17.648 24.4647 17.648C23.8499 17.648 23.5639 17.3284 23.3494 16.8559H23.3065C22.8633 17.2867 22.3485 17.7174 21.6908 17.7174C21.219 17.7174 20.6756 17.5924 20.6184 16.8837L19.8034 17.4256C19.0742 17.912 18.2163 18.1482 17.3441 18.1204C15.8284 18.1204 14.656 17.2867 14.656 15.7581C14.656 13.9099 16.5148 12.3397 18.2306 12.3397ZM17.1153 15.0633C17.387 14.9938 17.6586 14.8965 17.916 14.7715C18.1734 14.6325 18.3593 14.438 18.3736 14.1601C18.3879 13.8821 18.2592 13.6876 18.0304 13.6876C17.5729 13.6876 17.244 14.3546 17.1153 15.0633ZM19.2887 20.4411C19.2744 20.7468 19.3745 21.0386 19.5603 21.2748C19.2458 22.0113 18.6166 22.5533 17.6872 22.5533C17.3441 22.5394 17.0295 22.4143 16.7864 22.1781L16.4004 23.8595H14.7275L15.6712 19.5656C15.6997 19.4544 15.6426 19.3572 15.5282 19.3294C15.5139 19.3294 15.4996 19.3294 15.4853 19.3155C15.3995 19.3294 15.3137 19.3294 15.2279 19.3294C15.1707 19.3155 15.1278 19.2738 15.0992 19.2182C14.9419 18.9125 15.3423 18.3706 16.2145 18.4122C16.6434 18.44 16.8865 18.6068 17.0009 18.9264C17.2726 18.6068 17.6729 18.4122 18.1019 18.4122C18.8168 18.4122 19.4174 18.718 19.6747 19.3155C19.4317 19.6629 19.2887 20.052 19.2887 20.4411ZM18.0447 19.8574C18.0447 19.6768 18.0161 19.3989 17.7873 19.3989C17.53 19.3989 17.3298 19.7324 17.244 20.1215L17.1153 20.6912C17.0724 20.9135 16.9723 21.6083 17.3441 21.6083C17.8445 21.6083 18.0447 20.2604 18.0447 19.8574ZM26.252 19.2738C26.2663 19.5934 26.0233 19.8713 25.6944 19.8852C25.6658 19.8852 25.6515 19.8852 25.6229 19.8852C25.5085 19.8852 25.4084 19.8574 25.3083 19.8157L25.2797 19.8018C25.1653 19.7324 25.1224 19.649 24.9509 19.649C24.7507 19.649 24.6935 20.2604 24.6506 20.4272L24.2359 22.3587H22.6345L23.235 19.5795C23.2493 19.4683 23.2065 19.3433 23.0778 19.3433C23.0063 19.3572 22.9491 19.3711 22.8919 19.4128C22.8061 20.2743 21.5907 20.455 21.0331 20.6217C21.076 20.8441 21.2762 20.9969 21.5049 20.983C21.8338 20.9552 22.1627 20.8302 22.42 20.6356L22.8204 20.3577L22.5773 21.4277C22.1627 21.7056 21.6765 21.8307 21.1761 21.8168C20.3039 21.8168 19.6175 21.3443 19.6175 20.455C19.6175 19.385 20.6899 18.4539 21.6908 18.4539C22.0626 18.4539 22.4772 18.5651 22.7203 18.8291C22.9205 18.5929 23.235 18.4817 23.7069 18.4817C24.2073 18.4817 24.3646 18.718 24.5076 19.1487H24.5648C24.7364 18.8013 25.0224 18.5095 25.5085 18.5095C25.723 18.5095 25.9232 18.579 26.0661 18.718C26.1948 18.8569 26.2663 19.0654 26.252 19.2738ZM21.7623 19.4961C21.7623 19.3433 21.6908 19.2182 21.5621 19.2182C21.3048 19.2182 21.1189 19.6073 21.0474 20.0242C21.2047 19.9825 21.3619 19.9269 21.5049 19.8574C21.6622 19.788 21.7623 19.6629 21.7623 19.4961ZM15.1421 20.9413C15.1564 20.8441 15.0706 20.7607 14.9848 20.7468C14.899 20.7329 14.8132 20.7885 14.7989 20.8718C14.7989 20.9691 14.6989 21.0525 14.5988 21.0525C14.4701 21.0525 14.4415 20.9552 14.4558 20.8579L14.9705 18.4956H13.6122L13.2404 20.2326C13.1117 20.8024 13.0116 20.9969 12.8258 20.9969C12.5684 20.9969 12.6542 20.6773 12.6971 20.455L12.8829 19.5656C13.0116 18.9403 12.7114 18.44 11.9964 18.44C11.5818 18.44 11.2815 18.5512 11.0956 18.7596C11.067 18.8013 11.0384 18.8291 11.0098 18.8708C10.7239 18.44 10.0519 18.2872 9.53711 18.2872C8.45042 18.2872 7.39233 18.8847 7.37803 20.0381C7.36374 21.3443 9.07955 21.5666 9.06526 22.2059C9.07955 22.3726 8.95087 22.5116 8.77929 22.5116C8.76499 22.5116 8.75069 22.5116 8.72209 22.5116C8.6077 22.5116 8.50761 22.4838 8.40753 22.4282C8.36463 21.9835 8.00717 21.7334 7.56392 21.7334C7.23505 21.7473 6.96338 21.9974 6.94908 22.3309C6.93478 23.1508 7.97857 23.4009 8.6506 23.4009C9.79448 23.4009 10.9384 22.9979 10.9527 21.7056C10.967 20.3438 9.10815 19.913 9.12245 19.4544C9.10815 19.2877 9.23684 19.1348 9.42272 19.1209C9.43702 19.1209 9.45131 19.1209 9.46561 19.1209C9.6086 19.1209 9.75158 19.1626 9.86597 19.2321C9.90887 19.5934 10.1376 19.913 10.538 19.913C10.8526 19.9269 11.1099 19.6907 11.1242 19.3989C11.1528 19.2599 11.1814 19.1348 11.3816 19.1487C11.496 19.1487 11.5389 19.246 11.5246 19.3433L11.2386 20.7051C11.0241 21.6778 11.5389 21.8168 11.9678 21.8168C12.454 21.8168 12.8258 21.5111 13.1403 21.2053H13.1832C13.3405 21.5389 13.555 21.7751 13.9982 21.7751C14.6703 21.789 15.1421 21.4972 15.1421 20.9413Z" fill="white"/></g><defs><clipPath id="clip0_6_4"><rect width="32" height="27" fill="white"/></clipPath></defs></svg>
                    <span className="inline font-bold">Foz do Arelho</span>
                    {/* <img src="/logo.svg" className="w-[40px] md:w-[60px]" /> */}
                </Link>

                <Menu
                    // showCatMenu={showCatMenu}
                />

                {mobileMenu && (
                    <MenuMobile
                        setMobileMenu={setMobileMenu}
                    />
                )}

                <div className="flex items-center gap-2 text-black">
                    {/* Icon start */}
                    <div className="w-8 md:w-12 h-8 md:h-12 rounded-full flex justify-center items-center hover:bg-black/[0.05] cursor-pointer relative">
                        <IoMdHeartEmpty className="text-[19px] md:text-[24px]" />
                        <div className="h-[14px] md:h-[18px] min-w-[14px] md:min-w-[18px] rounded-full bg-red-600 absolute top-1 left-5 md:left-7 text-white text-[10px] md:text-[12px] flex justify-center items-center px-[2px] md:px-[5px]">
                            51
                        </div>
                    </div>
                    {/* Icon end */}

                    {/* Mobile icon start */}
                    <div className="w-8 md:w-12 h-8 md:h-12 rounded-full flex md:hidden justify-center items-center hover:bg-black/[0.05] cursor-pointer relative -mr-2">
                        {mobileMenu ? (
                            <VscChromeClose
                                className="text-[16px]"
                                onClick={() => setMobileMenu(false)}
                            />
                        ) : (
                            <BiMenuAltRight
                                className="text-[20px]"
                                onClick={() => setMobileMenu(true)}
                            />
                        )}
                    </div>
                    {/* Mobile icon end */}
                </div>
            </Wrapper>
        </header>
    );
};

export default Header;
